const xlsx = require('xlsx');
const path = require('path');

// ==========================================================
// ‚ö†Ô∏è –ù–ê–°–¢–†–û–ô–ö–ê: –£–∫–∞–∂–∏ –∏–º—è –û–î–ù–û–ì–û –∏–∑ —Ç–≤–æ–∏—Ö Excel-—Ñ–∞–π–ª–æ–≤
// ==========================================================
const FILE_TO_CHECK = 'result2022.xlsx'; // üëà –ó–∞–º–µ–Ω–∏ —ç—Ç–æ
// ==========================================================

const filePath = path.join(__dirname, FILE_TO_CHECK);

try {
    console.log(`üîé –ß–∏—Ç–∞—é —Ñ–∞–π–ª: ${FILE_TO_CHECK}...`);
    
    // 1. –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª
    const workbook = xlsx.readFile(filePath);
    
    // 2. –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π –ª–∏—Å—Ç
    const sheetName = workbook.SheetNames[0];
    const sheet = workbook.Sheets[sheetName];
    
    // 3. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –ª–∏—Å—Ç –≤ –º–∞—Å—Å–∏–≤, –≥–¥–µ `header: 1` 
    //    –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ (–∑–∞–≥–æ–ª–æ–≤–∫–∏) –±—É–¥–µ—Ç –ø–µ—Ä–≤—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –º–∞—Å—Å–∏–≤–∞
    const data = xlsx.utils.sheet_to_json(sheet, { header: 1 });

    if (data.length > 0) {
        // 4. –ë–µ—Ä–µ–º —Å–∞–º—É—é –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É (—ç—Ç–æ –∏ –µ—Å—Ç—å –Ω–∞—à–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏)
        const headers = data[0];
        
        console.log('‚úÖ –ù–∞—à–µ–ª —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç–æ–ª–±—Ü—ã –≤ —Ç–≤–æ–µ–º —Ñ–∞–π–ª–µ:');
        console.log('============================================');
        
        // 5. –í—ã–≤–æ–¥–∏–º –∏—Ö –≤ –≤–∏–¥–µ –∫—Ä–∞—Å–∏–≤–æ–≥–æ —Å–ø–∏—Å–∫–∞
        headers.forEach((headerName, index) => {
            console.log(` ${String(index + 1).padStart(3)}. ${headerName}`);
        });
        
        console.log('============================================');
        console.log('–¢–µ–ø–µ—Ä—å —Å–∫–æ–ø–∏—Ä—É–π –û–î–ù–û –∏–∑ —ç—Ç–∏—Ö –Ω–∞–∑–≤–∞–Ω–∏–π (–≤–∫–ª—é—á–∞—è –≤—Å–µ —Å–∏–º–≤–æ–ª—ã) –∏ –≤—Å—Ç–∞–≤—å –µ–≥–æ –≤ index.js');

    } else {
        console.log('‚ùå –§–∞–π–ª –ø—É—Å—Ç–æ–π –∏–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏.');
    }

} catch (error) {
    console.error(`üõë –û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞: ${error.message}`);
    console.error('–£–±–µ–¥–∏—Å—å, —á—Ç–æ –∏–º—è —Ñ–∞–π–ª–∞ –≤ "FILE_TO_CHECK" —É–∫–∞–∑–∞–Ω–æ –≤–µ—Ä–Ω–æ.');
}